syntax = "proto3";

package com.intentevolved;

// Kotlin/Java classes will be generated under com.intentevolved
option java_package = "com.intentevolved";
option java_multiple_files = true;

message IntentStream {
  Header header = 1;
  repeated Op ops = 2;
}


message Header {
  // a text description of the end intent of the whole stream
  // this object is effectively an intent with id '0'
  string rootIntent = 1;
  // todo: other details, like who wrote it, date started, etc

}
message Op {
  oneof payload {
    CreateIntent create_intent = 1;
    UpdateIntentText update_intent = 2;
    DeleteIntent delete_intent = 3;
  }
}

message CreateIntent {
  int64 id = 1; // this will be provided by the service
  string text = 2;
  // this is kind of ugly because everything has to have a parent
  // but what about the root intent? if you add a ton without parents
  // they all implicit have the root intent
  // so you'd think you want the initial intent to always have id 0
  // maybe what you want is the ops all follow some initial intent, there's like a preamble
  optional int64 parentId = 3;
}

message UpdateIntentText {
  int64 id = 1;
  string new_text = 2;
}

message UpdateIntentParent {
  int64 id = 1;
  int64 parentId = 2;
}

message DeleteIntent {
  int64 id = 1;
}